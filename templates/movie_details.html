{% extends "base.html" %}
{% block content %}

<h2>{{ movie.title }}</h2>

<div class="row mt-4">

    <div class="col-md-4">
        {% if poster %}
            <img src="{{ poster }}" class="img-fluid rounded">
        {% else %}
            <p>{% if lang=='hu' %}Nincs kép{% else %}No image{% endif %}</p>
        {% endif %}
    </div>

    <div class="col-md-8">

        <p>
            <strong>
                {% if lang == 'hu' %}Megjelenés dátuma:{% else %}Release date:{% endif %}
            </strong>
            {{ movie.release_date }}
        </p>

        <p>
            <strong>
                {% if lang == 'hu' %}Leírás:{% else %}Overview:{% endif %}
            </strong>
            {{ movie.overview }}
        </p>

        {% if avg_rating %}
            <p>
                <strong>
                    {% if lang == 'hu' %}Átlagos értékelés:{% else %}Average rating:{% endif %}
                </strong>
                {{ "%.1f"|format(avg_rating) }}/10
            </p>
        {% else %}
            <p>
                <strong>
                    {% if lang == 'hu' %}Átlagos értékelés:{% else %}Average rating:{% endif %}
                </strong>
                {% if lang == 'hu' %}nincs{% else %}none{% endif %}
            </p>
        {% endif %}

        <hr>

        {% if current_user.is_authenticated %}
            <!-- Értékelés -->
            <form method="POST" action="{{ url_for('rate_movie', movie_id=movie.id) }}">
                <label>
                    <strong>
                        {% if lang == 'hu' %}Saját értékelés:{% else %}Your rating:{% endif %}
                    </strong>
                </label>
                <select name="rating" class="form-select w-25">
                    {% for i in range(1, 11) %}
                        <option value="{{ i }}" {% if user_rating == i %}selected{% endif %}>
                            {{ i }}
                        </option>
                    {% endfor %}
                </select>
                <button class="btn btn-success mt-2">
                    {% if lang == 'hu' %}Értékelés{% else %}Rate{% endif %}
                </button>
            </form>

            <hr>

            <!-- Kedvencek -->
            {% if is_favorite %}
                <p>
                    <strong>
                        {% if lang == 'hu' %}
                            Ez a film a kedvencek között van ✔
                        {% else %}
                            This movie is in your favorites ✔
                        {% endif %}
                    </strong>
                </p>
            {% else %}
                <a href="{{ url_for('add_favorite', movie_id=movie.id) }}"
                   class="btn btn-warning">
                    {% if lang == 'hu' %}
                        Hozzáadás a kedvencekhez
                    {% else %}
                        Add to favorites
                    {% endif %}
                </a>
            {% endif %}
        {% else %}
            <p>
                <em>
                    {% if lang == 'hu' %}
                        Értékeléshez és kedvencekhez jelentkezz be.
                    {% else %}
                        Please log in to rate and add favorites.
                    {% endif %}
                </em>
            </p>
        {% endif %}

    </div>

</div>

{% endblock %}
